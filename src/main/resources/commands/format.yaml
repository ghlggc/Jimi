# ç¤ºä¾‹: ä»£ç æ ¼å¼åŒ–å‘½ä»¤
# ä½ç½®: ~/.jimi/commands/format.yaml

name: "format"
description: "æ ¼å¼åŒ– Java ä»£ç "
category: "code"
priority: 8

aliases:
  - "fmt"

usage: "/format [path]"

parameters:
  - name: "path"
    type: "path"
    defaultValue: "src"
    description: "è¦æ ¼å¼åŒ–çš„ç›®å½•æˆ–æ–‡ä»¶è·¯å¾„"

execution:
  type: "script"
  script: |
    #!/bin/bash
    set -e
    
    PATH_TO_FORMAT="${PATH:-src}"
    
    echo "ğŸ¨ æ ¼å¼åŒ– Java ä»£ç : $PATH_TO_FORMAT"
    
    # ä½¿ç”¨ google-java-format (å¦‚æœå¯ç”¨)
    if command -v google-java-format &> /dev/null; then
      find "$PATH_TO_FORMAT" -name "*.java" -exec google-java-format -i {} \;
      echo "âœ… æ ¼å¼åŒ–å®Œæˆ (ä½¿ç”¨ google-java-format)"
    else
      # å›é€€åˆ° Maven formatter
      if [ -f "pom.xml" ]; then
        mvn formatter:format
        echo "âœ… æ ¼å¼åŒ–å®Œæˆ (ä½¿ç”¨ Maven formatter)"
      else
        echo "âŒ æœªæ‰¾åˆ°æ ¼å¼åŒ–å·¥å…·"
        exit 1
      fi
    fi
  
  timeout: 120

requireApproval: false
enabled: true
