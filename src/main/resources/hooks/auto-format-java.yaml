name: "auto-format-java"
description: "ä¿å­˜ Java æ–‡ä»¶åè‡ªåŠ¨æ ¼å¼åŒ–"
enabled: true
priority: 10

trigger:
  type: "POST_TOOL_CALL"
  tools:
    - "WriteFile"
    - "StrReplaceFile"
  file_patterns:
    - "*.java"

execution:
  type: "script"
  script: |
    #!/bin/bash
    set -e
    
    # æ£€æŸ¥æ˜¯å¦å®‰è£…äº† google-java-format
    if ! command -v google-java-format &> /dev/null; then
      echo "âš ï¸  google-java-format æœªå®‰è£…,è·³è¿‡æ ¼å¼åŒ–"
      echo "   å®‰è£…: brew install google-java-format"
      exit 0
    fi
    
    # æ ¼å¼åŒ–æ‰€æœ‰ä¿®æ”¹çš„ Java æ–‡ä»¶
    for file in ${MODIFIED_FILES}; do
      if [[ $file == *.java ]]; then
        echo "ğŸ”§ æ ¼å¼åŒ–: $file"
        google-java-format -i "$file"
      fi
    done
    
    echo "âœ… Java æ–‡ä»¶æ ¼å¼åŒ–å®Œæˆ"
  workingDir: "${JIMI_WORK_DIR}"
  timeout: 30

conditions:
  - type: "env_var"
    var: "JIMI_AUTO_FORMAT"
    value: "true"
    description: "å¯ç”¨è‡ªåŠ¨æ ¼å¼åŒ–(è®¾ç½®ç¯å¢ƒå˜é‡ JIMI_AUTO_FORMAT=true)"
